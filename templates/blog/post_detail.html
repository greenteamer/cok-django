{% extends "base.html" %}
{% load static %}

{% block title %}{{ post.meta_title|default:post.title }} | Alex Dev{% endblock %}

{% block description %}{{ post.meta_description|default:post.excerpt }}{% endblock %}
{% block keywords %}{{ post.meta_keywords|default:"react native blog, mobile development" }}{% endblock %}
{% block og_type %}article{% endblock %}
{% block og_title %}{{ post.meta_title|default:post.title }} | Alex Dev{% endblock %}
{% block og_description %}{{ post.meta_description|default:post.excerpt }}{% endblock %}
{% block twitter_title %}{{ post.meta_title|default:post.title }} | Alex Dev{% endblock %}
{% block twitter_description %}{{ post.meta_description|default:post.excerpt }}{% endblock %}
{% block og_image %}{% if post.featured_image %}{{ request.scheme }}://{{ request.get_host }}{{ post.featured_image.url }}{% else %}{{ block.super }}{% endif %}{% endblock %}
{% block twitter_image %}{% if post.featured_image %}{{ request.scheme }}://{{ request.get_host }}{{ post.featured_image.url }}{% else %}{{ block.super }}{% endif %}{% endblock %}

{% block structured_data %}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "{{ post.title|escapejs }}",
  "description": "{{ post.meta_description|default:post.excerpt|escapejs }}",
  "datePublished": "{{ post.published_at|date:'c' }}",
  "dateModified": "{{ post.updated_at|date:'c' }}",
  "author": {
    "@type": "Person",
    "name": "{{ post.author.get_full_name|default:post.author.username|escapejs }}"
  },
  "mainEntityOfPage": "{{ canonical_url|default:request.build_absolute_uri|escapejs }}"{% if post.featured_image %},
  "image": "{{ request.scheme }}://{{ request.get_host }}{{ post.featured_image.url }}"{% endif %}
}
</script>
{% endblock %}

{% block content %}
<!-- Post Hero Section -->
<section class="BlogDetail__hero">
    <div class="Container">
        <div class="BlogDetail__heroContent">
            <div class="StatusBadge">
                <span class="StatusBadge__dot"></span>
                {{ post.category.name|default:"Blog Post" }}
            </div>
            <h1 class="Hero__title">{{ post.title }}</h1>

            <div class="BlogDetail__meta">
                <div class="BlogDetail__author">
                    By {{ post.author.get_full_name|default:post.author.username }}
                </div>
                <div class="PostCard__date">{{ post.published_at|date:"F d, Y" }}</div>
                {% if post.tags.exists %}
                <div class="BlogDetail__tags">
                    {% for tag in post.tags.all %}
                        <span class="Tag">{{ tag.name }}</span>
                    {% endfor %}
                </div>
                {% endif %}
            </div>
        </div>
    </div>
</section>

{% if post.featured_image %}
<!-- Featured Image Section -->
<section class="BlogDetail__featuredImage">
    <div class="Container">
        <div class="BlogDetail__imageWrapper">
            <img src="{{ post.featured_image.url }}" alt="{{ post.title }}" fetchpriority="high">
        </div>
    </div>
</section>
{% endif %}

<!-- Post Content Section -->
<section class="BlogDetail__contentSection">
    <div class="Container">
        <article class="BlogDetail__article">
            <div class="BlogDetail__body">
                {{ post.content|safe }}
            </div>
        </article>
    </div>
</section>

<!-- Post Navigation -->
{% if previous_post or next_post %}
<section class="BlogDetail__navigation">
    <div class="Container">
        <div class="BlogDetail__navWrapper">
            {% if previous_post %}
            <a href="{{ previous_post.get_absolute_url }}" class="BlogDetail__navLink BlogDetail__navLink--prev">
                <div class="BlogDetail__navLabel">← Previous Post</div>
                <div class="BlogDetail__navTitle">{{ previous_post.title }}</div>
            </a>
            {% else %}
            <div></div>
            {% endif %}

            {% if next_post %}
            <a href="{{ next_post.get_absolute_url }}" class="BlogDetail__navLink BlogDetail__navLink--next">
                <div class="BlogDetail__navLabel">Next Post →</div>
                <div class="BlogDetail__navTitle">{{ next_post.title }}</div>
            </a>
            {% else %}
            <div></div>
            {% endif %}
        </div>
    </div>
</section>
{% endif %}

<!-- Back to All Posts -->
<section class="BlogDetail__backToPosts">
    <div class="Container">
        <a href="/blog/" class="SectionHeader__link">← Back to all posts</a>
    </div>
</section>
{% endblock %}
